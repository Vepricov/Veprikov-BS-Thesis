\documentclass[aspectratio=169]{beamer}
\usepackage[utf8]{inputenc}
\usepackage{xeCJK}
\usepackage{graphicx}
\usepackage {mathtools}
\usepackage{utopia} %font utopia imported
\usetheme{CambridgeUS}
\usecolortheme{dolphin}

%%%%%%% Russian language %%%%%%%
\usepackage[russian]{babel}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[utf8]{inputenc}
\usepackage[T2A, T1]{fontenc}
\usepackage{fontspec}
\usefonttheme{serif}
\setmainfont{Times New Roman}

% set colors
\definecolor{myNewColorA}{RGB}{126,12,110}
\definecolor{myNewColorB}{RGB}{165,85,154}
\definecolor{myNewColorC}{RGB}{203,158,197}
\setbeamercolor*{palette primary}{bg=myNewColorC}
\setbeamercolor*{palette secondary}{bg=myNewColorB, fg = white}
\setbeamercolor*{palette tertiary}{bg=myNewColorA, fg = white}
\setbeamercolor*{titlelike}{fg=myNewColorA}
\setbeamercolor*{title}{bg=myNewColorA, fg = white}
\setbeamercolor*{item}{fg=myNewColorA}
\setbeamercolor*{caption name}{fg=myNewColorA}
\usefonttheme{professionalfonts}
\usepackage{natbib}
\usepackage{hyperref}
\newtheorem{theorem_rus}{Теорема}
\newtheorem{lemma_rus}{Лемма}
\setbeamertemplate{theorems}[numbered]
\setbeamertemplate{caption}[numbered]
%------------------------------------------------------------
%\titlegraphic{%\includegraphics[height=1.5cm]{nku-logo.eps}}

\setbeamerfont{title}{size=\large}
\setbeamerfont{subtitle}{size=\small}
\setbeamerfont{author}{size=\small}
\setbeamerfont{date}{size=\small}
\setbeamerfont{institute}{size=\small}
\title[Мат. модель эффекта обратной связки с системах ИИ]{Математическая модель эффекта обратной связи в системах искусственного интеллекта}
%\subtitle{The Top Forwards in the World}
%\author{Андрей Веприков \and Антон Хританков}
\subtitle{Выпускная квалификационная работа бакалавра}
\author[Веприков Андрей]{
    Веприков Андрей Сергеевич\\
    Научный руководитель: А.\,С.\,Хританков
}
\date[\today]{\today}
\institute[МФТИ (НИУ)]{
    Московский физико-технический институт\\
    (национальный исследовательский университет)\\
    Физтех-школа прикладной математики и информатики\\
    Кафедра интеллектуальных систем
}
\setbeamertemplate{navigation symbols}{}

%\institute[idk@rma.com]{ Nankai University

%School of Soccer}

%------------------------------------------------------------
%This block of commands puts the table of contents at the 
%beginning of each section and highlights the current section:
%\AtBeginSection[]
%{
%  \begin{frame}
%    \frametitle{Contents}
%    \tableofcontents[currentsection]
%  \end{frame}
%}
%\AtBeginSection[]{
% \begin{frame}
%  \vfill
%  \centering
%  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
%    \usebeamerfont{title}\insertsectionhead\par%
%  \end{beamercolorbox}
%  \vfill
%  \end{frame}
%}
%------------------------------------------------------------

%\input{macros}
\begin{document}

%The next statement creates the title page.
\frame{\titlepage}
%\begin{frame}
%\frametitle{Содержание}
%\tableofcontents
%\end{frame}
%------------------------------------------------------------
\section{Введение}
    \begin{frame}{Введение}
    \footnotesize
        При применении алгоритмов машинного обучения в реальных задачах часто наблюдается явление, когда среда и результаты работы модели начинают влиять друг на друга. Поэтому важно изучать системы искусственного интеллекта в долгосрочной перспективе. Примерами таких эффектов могут служить 
        \begin{enumerate}
            \item Эффекты петель обратной связи (feedback loop) (Khritankov, 2023a,b; Taori et al., 2023)

            \item Усиления ошибок (error amplification) (Mansoury et al., 2020; Adam et al. 2022) 

            \item Пузырей фильтров (filter bubbles) и эхо-камер (echo chambers) (Davies et al., 2018; Terren et al., 2021)
        \end{enumerate}
        \begin{figure}
            \centering
            \includegraphics[width=0.47\linewidth]{pictures/Sliding window.png}
            \includegraphics[width=0.47\linewidth]{pictures/Sampling update.png}
            \vspace{-2mm}
            \caption{\footnotesize{Две различные постановки эксперимента. Скользящее окно (слева) и обновление выборки (справа).}}
            \label{exp}
        \end{figure}

    \end{frame}
    
\section{Математическая модель эффекта обратной связи}
    \begin{frame}{Постановка задачи и теорема о предельном множестве}
        \footnotesize
        \vspace{-2mm}
        Определим следующую дискретную динамическую систему:
        \begin{equation}
            \label{system}
            f_{t+1}(x) = \text{D}_t(f_t)(x) ~ \text{ для } ~ \forall x \in \mathbb{R}^n, t \in \mathbb{N} ~\text{ и } ~ \text{D}_t \in \mathbb{D},
        \end{equation}
        где $\text{D}_t$ обычно называется оператором эволюции, $f_t(x)$ -- функции плотности вероятности распределения данных системы, а начальная функция $f_0(x)$ задана. 
        \vspace{-2mm}
        \begin{theorem_rus}[Veprikov et al., 2024] \label{delta}
        \vspace{-3mm}
            Для любой функции плотности $f_0(x), x \in \mathbb{R}^n$ и дискретной динамической системы \eqref{system}, если существуют $ g(x) \in L_1\left(\mathbb{R}^n\right)$ и $\psi_t \geq 0$ такие, что $f_t\left(x\right) \leq \psi_t^n \cdot |g(\psi_t \cdot x)|$ для всех $t \in \mathbb{N}$ и $x \in \mathbb{R}^n$.

            Тогда, если $\psi_t$ расходится к $\infty$, плотности $f_t(x)$ стремятся к дельта-функции, $f_t(x) \underset{t \to +\infty}{\longrightarrow} \delta(x)$ слабо.  

            Если $\psi_t$ сходится к нулю, тогда плотности $f_t(x)$ сходятся к нулевому распределению, $f_t(x) \underset{t \to +\infty}{\longrightarrow} \zeta(x)$ слабо.
        \end{theorem_rus}
        Для задачи регрессии, когда данные имеют вид $(X, y)$ Теорема \ref{delta} записывается не для данных в системе, а для случайного вектора невязок модели $h$, вида $y - h(X)$.
        
        Из Теоремы \ref{delta} можно вывести вид огибающих отображений $\text{D}_{\overline{1, t}}(\cdot) := \text{D}_t(\text{D}_{t-1} ( ... \text{D}_1( \cdot ) ... ))$, которые имеют вид
        \begin{equation} \label{cool_D}
            \text{D}_{\overline{1, t}}(f_0)(x) = \psi_t^n \cdot f_0(\psi_t \cdot x) \quad \forall x \in \mathbb{R}^n \text{ и } \forall t \in \mathbb{N}.
        \end{equation}
        Если операторы эволюции системы \eqref{system} имеют вид \eqref{cool_D}, можно записать формулу для вычисления $\psi_t$:
        \begin{equation}
            \psi_t \simeq f_t(0) .
        \end{equation}
        
    \end{frame}
    
    \begin{frame}{Анализ условий существования петель обратной связи и автономности системы \eqref{system}}
    \footnotesize
        \vspace{-1mm}
        Предположение 1, сформулированное в [1], гласит, что в системе \eqref{system} существует петля положительной обратной связи, если оператор $\text{D}_t$ является сжимающим в метрическом пространстве предсказаний модели.
        \vspace{-2mm}
        \begin{lemma_rus}[Veprikov et al., 2024] \label{moments}
        \vspace{-3mm}
            Если система \eqref{system} с $n=1$ удовлетворяет условиям Теоремы~\ref{delta} и $\psi_t \to \infty$, тогда все $2k$-тые моменты невязок 
            $y - h(X)$ убывают со скоростью как минимум $\psi_t^{-2k}$.
    
            Если оператор эволюции системы \eqref{system} удовлетворяет \eqref{cool_D}, тогда все (не только четные) моменты 
            $y - h(X)$ убывают со скоростью $\psi_t^{-k}$.
    
            Если существует $q \in [1; +\infty]$ такой, что $\{\nu_k^0\}_{k=1}^{+\infty} \in l_q$ и оператор эволюции системы \eqref{system} удовлетворяет \eqref{cool_D}, тогда $\{\nu_k^t\}_{k=1}^{+\infty} \in l_1$ и $\{\nu_k^t\}_{k=1}^{+\infty} \underset{t \to \infty}{\overset{l_1}{\longrightarrow}} 0$.
        \end{lemma_rus}
        Из Теоремы~\ref{delta} следует, что существует специальный вид отображений \eqref{cool_D}, для таких отображений можно вывести критерий автономности системы \eqref{system}.
        \vspace{-2mm}
        \begin{theorem_rus}[Veprikov et al., 2024] \label{semigroup}
        \vspace{-3mm}
            Если операторы эволюции $\text{D}_t$ динамической системы \eqref{system} имеют вид \eqref{cool_D}, тогда система \eqref{system} автономна тогда и только когда, когда
            \begin{equation} \label{cond_semigroup}
                \psi_{\tau + \kappa} = \psi_{\tau} \cdot \psi_{\kappa} ~\forall \tau, \kappa \in \mathbb{N}.
            \end{equation}
        \end{theorem_rus}
        
    \end{frame}
    
    \begin{frame}{Сохранение предельного множества при преобразовании признаков}
        \footnotesize
        Анализируется оператор $G$, осуществляющий преобразование $(X, y) \overset{G}{\to} (X', y')$ пространства признаков $X$ и целевой переменной $y$ для модели машинного обучения в задаче обучения с учителем. 
        %Целью данного раздела является нахождение достаточных условий, при которых предельное распределение для системы невязок, полученное с помощью Теоремы \ref{delta}, сохраняется при преобразовании $(X, y) \to G(X, y)$.  
        \vspace{-2mm}
        \begin{lemma_rus}[Веприков и др., 2023]
        \label{lemma_1}
        \vspace{-2mm}
            %Пусть в системе \eqref{system} для задачи обучения с учителем и $L(y, h, Z)$ – функция потерь модели $h$, а $(Z_t, y_t)$ – выборка на шаге $t$, $(Z'_t, y'_t) = G(Z_t, y_t)$ – выборка после применения оператора $G$. 
            \begin{enumerate}
                \item  
                Eсли $\exists~ T \in \mathbb{N} : $ для $\forall t \geq T$ выполнено $L(y_t, h_t, X_t) \geq L(y'_t, h'_t, X'_t)$ и функции плотности $y_t-h_t(X_t) \to \delta(x)$, то функции плотности $y'_t-h'_t(X'_t) \to \delta(x)$.
            
	           \item 
                Если же $\exists~ T \in \mathbb{N} : $ для $\forall t \geq T$ выполнено $L(y_t, h_t, X_t) \leq L(y'_t, h'_t, X'_t)$ и функции плотности $y_t-h_t(X_t) \to \zeta(x)$, то функции плотности $y'_t-h'_t(X'_t) \to \zeta(x)$.
           \end{enumerate}
        \end{lemma_rus}
        Квадратичная (MSE) и другие функции потерь, часто применяемые в задаче регрессии, могут быть разложены на составляющие смещения, разброса и неустранимого шума в данных: 
        $$L(y, h, X) = \text{Bias}^2(y, h, X) + \text{Var}(y, h, X) + \sigma^2.$$
        \vspace{-7mm}
        \begin{lemma_rus}[Веприков и др., 2023]
        \label{lemma_2}
        \vspace{-2mm}
            \begin{enumerate}
                \item Если $\exists~ T \in \mathbb{N} : $ для $\forall t \geq T$ преобразование $G$ уменьшает сумму смещения и разброса на шаге $t$, тогда $\forall t \geq T$ выполнено $L(y_t, h_t, X_t) \geq L(y'_t, h'_t, X'_t).$

                \item Если же $\exists~ T \in \mathbb{N} : $ для $\forall t \geq T$ преобразование $G$ увеличивает сумму смещения и разброса на шаге $t$, тогда $\forall t \geq T$ выполненно $L(y_t, h_t, X_t) \leq L(y'_t, h'_t, X'_t).$
            \end{enumerate}
        \end{lemma_rus}

    \end{frame}

\section{Эксперименты}
    \begin{frame}{Предел к дельта-функции или нулевому распределению}
    \footnotesize
    \vspace{-2mm}
        \begin{figure}
            \centering
            \includegraphics[width=0.45\linewidth]{pictures/ft0_sw_synthetic_sgd_model_50_1.0_0.0.png}~
            \includegraphics[width=0.45\linewidth]{pictures/ft0_sw_synthetic_sgd_model_50_1.0_3.0.png}

            \includegraphics[width=0.45\linewidth]{pictures/ft0_su_synthetic_sgd_model_50_1.0_0.0.png}~
            \includegraphics[width=0.45\linewidth]{pictures/ft0_su_synthetic_sgd_model_50_1.0_3.0.png}
            \vspace{-4mm}
            \caption{Постановка скользящее окно (сверху), обновление выборки (снизу).}
        \end{figure}
    \end{frame}

    \begin{frame}{Стремление моментов к нулю и исследование систем на автономность}
    \footnotesize
    \vspace{-2mm}
        \begin{figure}
            \centering
            \includegraphics[width=0.473\linewidth]{pictures/k_mom_sw_synthetic_sgd_model_50_1.0_0.0.png}~
            \includegraphics[width=0.473\linewidth]{pictures/k_mom_su_synthetic_sgd_model_50_1.0_0.0.png}
            
            \includegraphics[width=0.32\linewidth]{pictures/aut_sw_synthetic_sgd_model_50_1.0_0.0.png}
            \includegraphics[width=0.32\linewidth]{pictures/aut_su_synthetic_sgd_model_50_1.0_0.0.png}
            \includegraphics[width=0.32\linewidth]{pictures/aut_su_synthetic_sgd_model_50_1.0_3.0.png}
            \vspace{-5mm}
            \caption{Стремление моментов к нулю(сверху): скользящее окно(слева), обновление выборки(справа).
            \centering{Проверка автономности(снизу): скользящее окно(слева), обновление выборки(середина и справа).}}
        \end{figure}
    \end{frame}

    \begin{frame}{Сохранение предельного множества при преобразовании признаков}
        \footnotesize
        \vspace{-3mm}
        \begin{figure}
            \centering
            \includegraphics[width=0.45\linewidth]{pictures/conf_bvl_aif_1.0_0.0.png}~
            \includegraphics[width=0.45\linewidth]{pictures/conf_delta_aif_1.0_0.0.png}

            \includegraphics[width=0.45\linewidth]{pictures/conf_bvl_anf_1.0_0.0.png}~
            \includegraphics[width=0.45\linewidth]{pictures/conf_delta_anf_1.0_0.0.png}
            \vspace{-3mm}
            \caption{Добавление информативных (сверху) и неинформативных (снизу) признаков.}
        \end{figure}
    \end{frame}

\section{Вывод}
    
    \begin{frame}{Вывод}
        \begin{enumerate}
            \footnotesize
            \item В данной работе построена математическая модель эффекта петель обратной связи с использованием дискретных динамических систем

            \item Были получены результаты для определения предельного множества динамической системы, достаточных условий существования петли обратной связи, критерий автономности и достаточные условия сохранения предельного множества при преобразовании признаков

            \item В данной работе на языке Python разработан стенд проведения вычислительных экспериментов, симулирующий процесс многократного машинного обучения

            % \item Все полученные результаты строго доказаны и проверены в вычислительном эксперименте.
            
            \item Полученные результаты применимы для контроля качества систем ИИ в медицине, персонализации образования, широком классе СППР для выполнения требований кодекса этики в сфере ИИ и требований ГОСТ

            \item Мой вклад в данное исследование состоит в доказательстве теоретических исследований, участие в постановке экспериментов, сборе, обработке и анализе их результатов

            \item По результатам работы была подана статья в Q1 журнал (Veprikov et al., 2024), рассказано выступление на конференции ММРО-2023 (Веприков и др., 2023), материалы которой были поданы в журнал ИИПР
        \end{enumerate}

    \end{frame}

\section{Список литературы}
    \begin{frame}{Список литературы}
        \scriptsize

        \begin{enumerate}
            \item[1] \textcolor{myNewColorA}{(Veprikov et al., 2024)} Veprikov A.,   Afanasiev A., Khritankov A. A Mathematical Model of the Hidden Feedback Loop Effect in Machine Learning Systems // arXiv preprint \url{https://arxiv.org/abs/2405.02726}
            
            \item[2] \textcolor{myNewColorA}{(Веприков и др., 2023)} Веприков А. С., Афанасьев А. П., Хританков А.С. Математическая модель эффекта обратной связи в системах искусственного интеллекта // Сборник тезисов 21-й Всероссийской конференции Математические методы распознавания образов (ММРО-21). – Российская академия наук, 2023. – С. 35-37 
            
            \item[3] \textcolor{myNewColorA}{(Khritankov, 2023)} Khritankov A. Hidden feedback loops in machine learning systems: A simulation model and preliminary results // Software Quality: Future Perspectives on Software Engineering Quality: 13th International Conference, SWQD 2021, Vienna, Austria, January 19–21, 2021, Proceedings 13. – Springer International Publishing, 2021. – С. 54-65.

            %\item \textcolor{myNewColorA}{(Khritankov, 2023b)} Khritankov A. Positive feedback loops lead to concept drift in machine learning systems // Applied Intelligence. – 2023. – Т. 53. – №. 19. – С. 22648-22666. 
            
            \item[4] \textcolor{myNewColorA}{(Taori et al., 2023)} Taori R., Hashimoto T. Data feedback loops: Model-driven amplification of dataset biases // International Conference on Machine Learning. – PMLR, 2023. – С. 33883-33920.
            
            \item[5] \textcolor{myNewColorA}{(Adam et al., 2022)} Adam G. A. et al. Error amplification when updating deployed machine learning models // Machine Learning for Healthcare Conference. – PMLR, 2022. – С. 715-740.

            \item[6] \textcolor{myNewColorA}{(Terren et al., 2021)} Terren L. T. L., Borge-Bravo R. B. B. R. Echo chambers on social media: A systematic review of the literature // Review of Communication Research. – 2021. – Т. 9.

            \item[7] \textcolor{myNewColorA}{(Mansoury et al., 2020)} Mansoury M. et al. Feedback loop and bias amplification in recommender systems //Proceedings of the 29th ACM international conference on information and knowledge management. – 2020. – С. 2145-2148.

            \item[8] \textcolor{myNewColorA}{(Davies et al., 2018)} Davies H. C. Redefining filter bubbles as (escapable) socio-technical recursion // Sociological Research Online. – 2018. – Т. 23. – №. 3. – С. 637-654.

        \end{enumerate}
    \end{frame}

\end{document}
